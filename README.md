# Hackattic Backup Restore Challenge

Решение задания по восстановлению резервных копий базы данных PostgreSQL.

## Требования

### Системные зависимости
- **curl** - для HTTP запросов к API
- **jq** - для обработки JSON данных
- **base64** - для декодирования (предустановлен в большинстве систем)
- **gunzip** - для распаковки архивов (предустановлен в большинстве систем)
- **Docker** - для запуска PostgreSQL контейнера

### Установка зависимостей

#### Ubuntu/Debian
```bash
sudo apt update
sudo apt install -y curl jq docker.io
sudo systemctl start docker
sudo usermod -aG docker $USER
```

#### CentOS/RHEL
```bash
sudo yum install -y curl jq docker
sudo systemctl start docker
sudo usermod -aG docker $USER
```

#### macOS
```bash
brew install curl jq
# Установите Docker Desktop с https://www.docker.com/products/docker-desktop
```

## Запуск

### Вариант 1: С предустановленным токеном
```bash
export HACKATTIC_ACCESS_TOKEN="ваш_токен_здесь"
./restore.sh
```

### Вариант 2: С интерактивным вводом токена
```bash
./restore.sh
# Скрипт предложит ввести токен при запуске
```

### Вариант 3: Токен в одной строке
```bash
HACKATTIC_ACCESS_TOKEN="ваш_токен_здесь" ./restore.sh
```

## Описание работы

Скрипт автоматически выполняет 7 шагов:
1. **[1/6] Скачивание дампа** - получает зашифрованный дамп PostgreSQL через API, показывает ответ сервера
2. **[2/6] Распаковка архива** - декодирует base64 и распаковывает gzip в SQL файл
3. **[3/6] Запуск PostgreSQL** - создает Docker контейнер `postgresql-host` с PostgreSQL 17.6
4. **[4/6] Восстановление дампа** - импортирует данные в базу данных hackattic
5. **[5/6] Выполнение запроса** - извлекает и отображает SSN записи со статусом 'alive'
6. **[6/6] Отправка данных** - отправляет результат обратно через API Hackattic
7. **[7/7] Очистка ресурсов** - удаляет контейнер и временные файлы

## Примечания

- Требуется активное подключение к интернету
- Docker должен быть запущен
- Контейнер создается с именем `postgresql-host` и автоматически пересоздается при повторном запуске
- Временные файлы автоматически удаляются после завершения
- Используется официальный образ PostgreSQL 17.6
- Скрипт показывает детальную информацию о каждом шаге выполнения
- Если токен не задан в переменной окружения, скрипт предложит ввести его интерактивно
- Ответ сервера отображается для отладки